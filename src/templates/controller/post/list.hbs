import { Logger } from '@agrippa-io/node-utils'
import { mongoose } from '@agrippa-io/node-mongoose'
import { UseCaseExecutor } from '@agrippa-io/node-mongoose'
import express from 'express'
import MODEL from '../../constants/models'
import {{ pascalCase model }}CreateMany from '../../usecases/{{ pascalCase model }}/post.list.mongoose'
import InterfaceMongooseModel{{ pascalCase model }} from '../../models/{{ pascalCase model }}/interfaces/document'


export default async (request : express.Request, response : express.Response) => {
  Logger.route('POST /v3/{{ snakeCase model }}s/many')
  const { body } = request

  const data : InterfaceMongooseModel{{ pascalCase model }}[] = body
  const createMany{{ pascalCase model }}s = new {{ pascalCase model }}CreateMany({
    data,
    options: {}
  })

  await createMany{{ pascalCase model }}s.perform()

  UseCaseExecutor.renderUseCase(createMany{{ pascalCase model }}s, request, response, {
    rootModel: MODEL.{{ constantCase model }}
  })
}
